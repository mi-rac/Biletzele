{% extends "index.html" %}

{% block content %}

{% include 'info.html' %}

<div align="center" id='content'>

</div>

<br>

<form action="/game/{{ room }}/{{ username }}" method="POST">
    <div align="center" id="next_button">

    </div>
</form>


<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
<script>
    var socket = io.connect('http://' + document.domain + ':' + location.port);
    socket.on('connect', function() {
        socket.emit('join_waiting', {
            'room': "{{ room }}"
        });
    });

    socket.on('update_stats', function(data) {
        if (data.room == "{{ room }}") {
            document.getElementById("words_left").innerHTML =`${data.num_words}`;
            document.getElementById("score_red").innerHTML =`${data.score[0]}`;
            document.getElementById("score_blue").innerHTML =`${data.score[1]}`;
        };
    });

    socket.on('display_next', function(data) {
        if (data.room == "{{ room }}" && data.username == "{{ username }}") {
            document.getElementById("next_button").innerHTML =
                `<button type='submit' class="button button_green">Next</button>`;
            document.getElementById("content").innerHTML = `<h3>Your turn!</h3>`;
        };
    });

    socket.on('info_waiting', function(data) {
        if (data.room == "{{ room }}" && data.username != "{{ username }}") {
            document.getElementById("content").innerHTML =
                `${data.username} is about to start picking for team ${data.color}.<br>
                 Pay attention to what they say or do.`;
        };
    });


</script>

{% endblock %}
