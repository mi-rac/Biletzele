{% extends "index.html" %}

{% block content %}
<div>
    <label>Share the room ID with all other players:</label><br>
    <b>{{ room }}</b>
</div>

<div id='users'>

</div>

<div>
    <form action='/home/{{ username }}'>
        <button id='leave' class="button button2" type="submit">Exit Room</button>
    </form>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
<script>
    const socket = io.connect("http://127.0.0.1:5000");

    socket.on('connect', function () {
        socket.emit('join_room', {
            username: "{{ username }}",
            room: "{{ room }}",
            users: "{{ users }}"
        });
    });

    socket.on('update_user_list', function(data) {
        if (data.room == "{{ room }}") {
            const newNode = document.createElement('div');
            document.getElementById('users').innerHTML = `<b>${data.users}</b> has joined the room`;
        };
    });

    document.getElementById("leave").onclick = function() {
        socket.emit('leave_room', {
            username: "{{ username }}",
            room: "{{ room }}"
        });
    };

</script>
{% endblock %}
